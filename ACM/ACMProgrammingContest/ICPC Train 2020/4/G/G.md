球接触多边形的一侧时会下沉。我们将对所有方面进行排序，并找到每个方面的首次触摸时间。那么问题的答案将是所获得的时间中最少的。 考虑第一面。在不失一般性的前提下，我们假设它是垂直的（水平的情况也可以通过坐标的变化来类似地求解）。我们设$y_1=y_{i,1}$ 和$y_2=y_{i,2}$ ，那么应当满足 $x=x_s$ 且 $y_1 \leq y \leq y_2$ 。

 为了方便起见，球场本身会反射，而不是从高尔夫球场的侧面反射球。在这种情况下，球将沿直线飞行 $(\mathop{x}\limits^˜+t,\mathop{y}\limits^˜ +t )$，并且所考虑的多边形的侧面将在大小为 $2*h*w$的晶格上给出无限的分段序列。我们列出这些段的所有类型：

$x=2wk+x_s,2hl+y_1 \leq y \leq 2hl+y2$

$x=2wk+x_s,2hl+2h-y_2 \leq y \leq 2hl+2h-y_1$

$x=2wk+2w-x_s,2hl+y_1 \leq y \leq 2hl+y2$

$x=2wk+2w-x_s,2hl+2h-y_2 \leq y \leq 2hl+2h-y_1$

其中 $k$ 和$ l$ 是整数。我们求出每种情况的答案，最后再取最小值 。

球轨迹与周期为 $2w$ 的$ x = 2wk + x$ 形式的直线序列相交。因此，当 $0 \leq t0<2w$ 和$ k \geq 0$，交会时间可以记为为$ t_k = t_0 + 2wk$。我们找到了最小k的解。首先我们考虑 k =0，如果 $y_1 \leq \mathop{y}\limits^˜+t_0 \leq y_2$， 则找到答案。否则，问题将简化为找到形式为$L \leq ak \mod m \leq R$的不等式的最小解，其中 $m=2hl，a=2w，L =(y_1-\mathop{y}\limits^˜) \mod m，R =(y_2-y〜) \mod m$。

我们通过考虑几种情况来解决这个不等式：

1. 如果 $2a> m$，则我们将不等式的解简化为 $m-R≤((m-a)*k)modm≤m-L$ 。
2. 如果 $k = \lceil \frac{L}{a} \rceil $ 是答案，那么它会很小。
3. 如果 m 可被 a 整除，则不存在解。  

4. 否则，在每个溢出模 m 之后考虑第一个值。每次它将更改为 $m \mod a$。我们需要找到满足模 a 且落入区间 L mod a至R mod a 的最小值。由于第二种情况没有找到答案，则$k = \lceil \frac{L}{a} \rceil $不是解，并且 $L \mod a <R \mod a$。所以 因此，我们将问题简化为解决不等式$(L \mod a)≤((a-(m \mod a)*k′≤(R \mod a )$.我们用相同的算法解决。令$ k′$为新不等式的最小解，然后$\lceil \frac{k'm+l}{a} \rceil$为原始不等式的最小解。如果新的不等式不存在解，那么原来的不等式也没有解。

时间复杂度：$tnlog(wh)$